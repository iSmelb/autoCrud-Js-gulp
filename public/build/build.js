"use strict";function createDomElement(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=document.createElement(e);if(t)for(var i in t)r.setAttribute(i,t[i]);return r.innerText=n,r}
"use strict";function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pushElement(e,t){e.push(t)}function checkLocal(){var e=localStorage.getItem("arrProducts");e&&(arrProducts=JSON.parse(e));e=localStorage.getItem("arrCars");e&&(arrCars=JSON.parse(e));e=localStorage.getItem("arrUsers");e&&(arrUsers=JSON.parse(e))}function setLocal(e){var t;e===arrProducts?(t=JSON.stringify(e),localStorage.setItem("arrProducts",t)):e===arrCars?(t=JSON.stringify(e),localStorage.setItem("arrCars",t)):e===arrUsers&&(t=JSON.stringify(e),localStorage.setItem("arrUsers",t))}function mainPage(){var e=document.querySelector(".logo"),t=document.querySelector(".Cars_Title"),r=document.querySelector(".User_Title"),n=document.querySelector(".Product_Title");e.addEventListener("click",function(){document.querySelector("main").innerHTML="",t.classList.remove("active"),r.classList.remove("active"),n.classList.remove("active")})}function createMenu(){var e=createDomElement("div",{class:"Product_Title"});e.innerText="Products",e.addEventListener("click",function(){createListElements(arrProducts),t.classList.remove("active"),r.classList.remove("active"),e.classList.add("active")});var t=createDomElement("div",{class:"Cars_Title"});t.innerText="Cars",t.addEventListener("click",function(){createListElements(arrCars),r.classList.remove("active"),e.classList.remove("active"),t.classList.add("active")});var r=createDomElement("div",{class:"User_Title"});r.innerText="Users",r.addEventListener("click",function(){createListElements(arrUsers),e.classList.remove("active"),t.classList.remove("active"),r.classList.add("active")}),document.querySelector(".btn-wrapper").append(e,t,r)}function removeActiveClass(){}function createUlinfo(e,t){for(var r in t){var n=document.createElement("li"),o=document.createElement("span"),a=document.createElement("span");if(o.innerText=r,a.innerText=t[r],n.append(o,a),"id"!==r){if("boughtItem"===r&&0!==t[r].length){for(var c="".concat(t[r][0].name,"(").concat(t[r][0].count,"); "),s=1;s<t[r].length;s++)c+="".concat(t[r][s].name,"(").concat(t[r][s].count,"); ");o.innerText=r,a.innerText=c,n.append(o,a)}e.appendChild(n)}}}function createDivElement(e,t){var r=createDomElement("div",{class:"List_element",data_id:e.id}),n=createDomElement("div",{class:"div_for_info"}),o=createDomElement("div",{class:"div_for_button"}),a=createDomElement("h4",{},t.indexOf(e)+1+"."+e.name),c=createDomElement("ul",{class:"information"});createUlinfo(c,e),n.append(a,c);var s=createDomElement("button",{class:"view",title:"View"});s.addEventListener("click",function(e){return showUl(e)});a=createDomElement("button",{class:"edit",title:"Edit"});a.addEventListener("click",function(){return editInfo(r,t)});var c=createDomElement("button",{class:"delete",title:"Delete"});c.addEventListener("click",function(e){return deletElement(e,r,t)}),o.append(s,a,c),t!==arrUsers&&(c=createDomElement("button",{class:"sale",title:"Sell"}),Number(0===e.count)&&c.setAttribute("disabled","disabled"),c.addEventListener("click",function(){return createCustomerList(r,t)}),o.append(c)),r.append(n,o),document.querySelector("main").appendChild(r)}function deletElement(r,e,n){document.body.classList.add("stop-scrolling");var o=Number(e.getAttribute("data_id")),t=createDomElement("div",{class:"confirmDelet"});t.classList.toggle("show");var a=createDomElement("div",{class:"yes_or_no"}),c=createDomElement("span",{},"Are u sure u want delete ".concat(e.querySelector("h4").innerText,"?")),s=createDomElement("button",{},"Yes");s.addEventListener("click",function(){for(var e,t=0;t<n.length;t++)if(o===n[t].id){n.splice(n.indexOf(n[t]),1);break}setLocal(n),0===n.length&&(e=createDomElement("strong",{class:"listEmpty"},"The list is empty"),document.querySelector("main").appendChild(e)),document.querySelector("main").removeChild(r.target.parentNode.parentNode),document.body.removeChild(document.querySelector(".confirmDelet")),document.body.classList.remove("stop-scrolling")});e=createDomElement("button",{},"No");e.addEventListener("click",function(){document.body.removeChild(document.querySelector(".confirmDelet")),document.body.classList.remove("stop-scrolling")}),a.append(c,s,e),t.append(a),document.body.appendChild(t)}function showUl(e){e.target.parentNode.parentNode.querySelector("ul").classList.toggle("show")}function createListElements(e){document.querySelector("main").innerHTML="";var t=createDomElement("button",{class:"button_for_add"},"Add new");t.addEventListener("click",function(){return createFormForAdd(e)}),document.querySelector("main").appendChild(t);var r,n=_createForOfIteratorHelper(e);try{for(n.s();!(r=n.n()).done;)createDivElement(r.value,e)}catch(e){n.e(e)}finally{n.f()}0===e.length&&(t=createDomElement("strong",{class:"listEmpty"},"The list is empty"),document.querySelector("main").appendChild(t))}function createFormForAdd(e){var t=["#product-template","#auto-template","#user-template"];e===arrProducts?r=t[0]:e===arrCars?r=t[1]:e===arrUsers&&(r=t[2]);var t=document.querySelector(r).content.cloneNode(!0),r=createDomElement("div",{class:"conteiner_for_form"});document.body.classList.toggle("stop-scrolling"),r.append(t),document.body.appendChild(r),document.querySelector(".save_info_button").addEventListener("click",function(){return errorOrConfirm(addNewElemet,e)}),document.querySelector(".back_to_list_button").addEventListener("click",deletForm)}function addNewElemet(e){var t,r=document.forms[0].elements;e===arrProducts?(t=new Product(r.name.value,r.count.value,r.price.value,r.characteristics.value),e.push(t)):e===arrCars?(t=new Auto(r.name.value,r.count.value,r.price.value,r.transmission.value,r.characteristics.value),e.push(t)):e===arrUsers&&(t=new User(r.firstname.value,r.age.value,r.email.value,r.phonenumber.value,r.balance.value),e.push(t)),setLocal(e),1===e.length&&document.querySelector(".listEmpty").remove(),createDivElement(t,e),deletForm()}var dataIdElement,elementForEditOnArr;function editInfo(e,t){document.body.classList.toggle("stop-scrolling");var r=["#product-template","#auto-template","#user-template"];t===arrProducts?n=r[0]:t===arrCars?n=r[1]:t===arrUsers&&(n=r[2]);var r=document.querySelector(n).content.cloneNode(!0),n=createDomElement("div",{class:"conteiner_for_form"});n.append(r),document.body.appendChild(n);var o=document.forms[0].elements;setInputOnForm(dataIdElement=Number(e.getAttribute("data_id")),t,o);e=document.querySelector(".save_info_button");t===arrProducts||t===arrCars?e.addEventListener("click",function(){return editElementProductOrCar(t,o)}):e.addEventListener("click",function(){return editElementUser(t,o)}),document.querySelector(".back_to_list_button").addEventListener("click",deletForm)}function setInputOnForm(e,t,r){if(t===arrProducts){for(var n=0;n<t.length;n++)if(e===t[n].id){elementForEditOnArr=t.indexOf(t[n]),r.name.value=t[n].name,r.count.value=t[n].count,r.price.value=t[n].price,t[n].characteristics&&(r.characteristics.value=t[n].characteristics);break}}else if(t===arrCars){for(var o=0;o<t.length;o++)if(e===t[o].id){elementForEditOnArr=t.indexOf(t[o]),r.name.value=t[o].name,r.count.value=t[o].count,r.price.value=t[o].price,r.transmission.value=t[o].transmission,t[o].characteristics&&(r.characteristics.value=t[o].characteristics);break}}else if(t===arrUsers)for(var a=0;a<t.length;a++)if(e===t[a].id){elementForEditOnArr=t.indexOf(t[a]),r.firstname.value=t[a].name,r.age.value=t[a].age,r.email.value=t[a].email,r.phonenumber.value=t[a].tel,r.balance.value=t[a].balance;break}}function deletForm(){document.querySelector(".conteiner_for_form").remove(),document.body.classList.toggle("stop-scrolling")}function editElementProductOrCar(e,t){e[elementForEditOnArr].name=t.name.value,e[elementForEditOnArr].count=t.count.value,e[elementForEditOnArr].price=t.price.value,e[elementForEditOnArr].characteristics=t.characteristics.value,e[elementForEditOnArr].transmission&&(e[elementForEditOnArr].transmission=t.transmission.value);t=document.querySelector('.List_element[data_id="'+dataIdElement+'"]').querySelector(".sale");0<e[elementForEditOnArr].count&&t.removeAttribute("disabled"),errorOrConfirm(saveAndEdit,e)}function editElementUser(e,t){e[elementForEditOnArr].name=t.firstname.value,e[elementForEditOnArr].age=t.age.value,e[elementForEditOnArr].email=t.email.value,e[elementForEditOnArr].tel=t.phonenumber.value,e[elementForEditOnArr].balance=t.balance.value,errorOrConfirm(saveAndEdit,e)}function showErrorForm(e){e.parentElement.classList.add("error"),e.classList.add("error"),setTimeout(function(){e.classList.remove("error"),e.parentElement.classList.remove("error")},2500)}function errorOrConfirm(e,t){var r,n=document.forms[0];t===arrUsers?(r=new FormData(n),validFormUser(Object.fromEntries(r))&&e(t)):t===arrCars?(r=new FormData(n),validFormCar(Object.fromEntries(r))&&e(t)):t===arrProducts&&(n=new FormData(n),validFormProduct(Object.fromEntries(n))&&e(t))}function validFormUser(e){var t=!0;return namePattern.test(e.firstname)||(showErrorForm(document.forms[0].elements.firstname),t=!1),agePattern.test(e.age)||(showErrorForm(document.forms[0].elements.age),t=!1),emailPattern.test(e.email)||(showErrorForm(document.forms[0].elements.email),t=!1),phoneNumberPattern.test(e.phonenumber)||(showErrorForm(document.forms[0].elements.phonenumber),t=!1),balancePricePattern.test(e.balance)||(showErrorForm(document.forms[0].elements.balance),t=!1),t}function validFormProduct(e){var t=!0;return namePattern.test(e.name)||(showErrorForm(document.forms[0].elements.name),t=!1),countItemForSell.test(e.count)||(showErrorForm(document.forms[0].elements.count),t=!1),balancePricePattern.test(e.price)||(showErrorForm(document.forms[0].elements.price),t=!1),t}function validFormCar(e){var t=!0;return namePattern.test(e.name)||(showErrorForm(document.forms[0].elements.name),t=!1),countItemForSell.test(e.count)||(showErrorForm(document.forms[0].elements.count),t=!1),balancePricePattern.test(e.price)||(showErrorForm(document.forms[0].elements.price),t=!1),""===document.forms[0].elements.transmission.value&&(showErrorForm(document.forms[0].elements.transmission),t=!1),t}function saveAndEdit(e){document.querySelector('.List_element[data_id="'+dataIdElement+'"]').querySelector("h4").innerText=e.indexOf(e[elementForEditOnArr])+1+"."+e[elementForEditOnArr].name;var t=document.querySelector('.List_element[data_id="'+dataIdElement+'"]').querySelector(".information");t.innerHTML="",createUlinfo(t,e[elementForEditOnArr]),setLocal(e),document.forms[0]&&deletForm()}function createCustomerList(o,a){document.body.classList.toggle("stop-scrolling");var e=createDomElement("div",{class:"customer_list_conteiner"}),c=createDomElement("div",{class:"customer_list"}),t=createDomElement("div",{class:"close_customer_list"},"close");t.addEventListener("click",function(){document.querySelector(".customer_list_conteiner").remove(),document.body.classList.toggle("stop-scrolling")}),c.append(t);for(var r=0;r<arrUsers.length;r++)!function(e){var t=createDomElement("div",{class:"customer_list_user",data_user_id:arrUsers[e].id}),r=createDomElement("label",{},"".concat(arrUsers.indexOf(arrUsers[e])+1,". ").concat(arrUsers[e].name," ($").concat(arrUsers[e].balance,")")),n=createDomElement("input",{type:"number",placeholder:"Enter a count product"}),e=createDomElement("button",{},"sell");e.addEventListener("click",function(e){return sellItem(e,o,a,t)}),r.append(n),t.append(r,e),c.append(t)}(r);e.append(c),document.body.append(e)}function sellItem(e,t,r,n){var o,a,c,s=Number(t.getAttribute("data_id")),l=Number(n.getAttribute("data_user_id")),i=Number(document.querySelector('.customer_list_user[data_user_id="'+l+'"]').querySelector("input").value),t=document.querySelector('.List_element[data_id="'+s+'"]').querySelector(".sale"),m=_createForOfIteratorHelper(r);try{for(m.s();!(c=m.n()).done;){var u=c.value;if(u.id===s){o=u,elementForEditOnArr=r.indexOf(u);break}}}catch(e){m.e(e)}finally{m.f()}var d,v=_createForOfIteratorHelper(arrUsers);try{for(v.s();!(d=v.n()).done;){var f=d.value;if(f.id===l){a=f;break}}}catch(e){v.e(e)}finally{v.f()}if(i<=Number(o.count)&&0<i){n=i*o.price;if(n<=a.balance){a.balance-=n,o.count-=i,0===o.count&&t.setAttribute("disabled","disabled");var p={name:o.name,count:i};if(0===a.boughtItem.length)a.boughtItem.push(p);else for(var E=0;E<a.boughtItem.length;E++){if(a.boughtItem[E].name===p.name){a.boughtItem[E].count+=p.count;break}if(E===a.boughtItem.length-1){a.boughtItem.push(p);break}}dataIdElement=s,saveAndEdit(r);i=JSON.stringify(arrUsers);localStorage.setItem("arrUsers",i),document.body.removeChild(document.querySelector(".customer_list_conteiner")),document.body.classList.toggle("stop-scrolling")}else showError(e,"errorBalance")}else showError(e,"errorCount")}function showError(e,t){e.target.parentNode.querySelector("input").focus(),e.target.parentNode.querySelector("input").classList.add("error"),e.target.parentNode.classList.add(t),setTimeout(function(){e.target.parentNode.querySelector("input").classList.remove("error"),e.target.parentNode.classList.remove(t)},2500)}
"use strict";function _classCallCheck(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var Auto=function s(t,a,i,r,n){_classCallCheck(this,s),0===arrCars.length?this.id=1:this.id=arrCars[arrCars.length-1].id+1,this.name=t,this.count=a,this.price=i,this.transmission=r,this.characteristics=n};
"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var Product=function t(s,c,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";_classCallCheck(this,t),0===arrProducts.length?this.id=1:this.id=arrProducts[arrProducts.length-1].id+1,this.name=s,this.count=c,this.price=i,this.characteristics=r};
"use strict";function _classCallCheck(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var User=function s(t,a,i,e,r){_classCallCheck(this,s),0===arrUsers.length?this.id=1:this.id=arrUsers[arrUsers.length-1].id+1,this.name=t,this.age=a,this.email=i,this.tel=e,this.balance=r,this.boughtItem=[]};
"use strict";var arrProducts=[],arrCars=[],arrUsers=[];pushElement(arrProducts,new Product("колесо",4,1e3,"круглое")),pushElement(arrProducts,new Product("руль",1,500)),pushElement(arrCars,new Auto("mustang",4,3e4,"auto","Цвет: черный, Салон: белый")),pushElement(arrCars,new Auto("lada granta",10,6e3,"manual","Цвет: синий, Салон: коричневый")),pushElement(arrUsers,new User("Антон",30,"anton@mail.ru","+380669823453","10000")),pushElement(arrUsers,new User("Алина",20,"alina@mail.ru","+380662352433","25000"));
"use strict";checkLocal(),createMenu(),mainPage(),console.log(arrUsers),console.log(arrCars),console.log(arrProducts);var namePattern=/[A-Za-zА-Яа-я]+/,agePattern=/^\d\d$/,emailPattern=/^[a-zA-Z0-9].+@[a-z]{3,}.[a-z]{2,}$/,phoneNumberPattern=/(^(\+)([0-9]{4,15})$)/,balancePricePattern=/^([1-9]{1})$|(^[1-9]{1}\d{1,5}$)/,countItemForSell=/^([1-9]{1})$|(^[1-9]{1}\d{1}$)/;